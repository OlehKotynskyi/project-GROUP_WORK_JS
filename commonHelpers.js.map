{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart.js","../src/cart-page.js"],"sourcesContent":["import { createMarkupCart } from './template.js';\nimport addCounter from './cart-header-counter';\nconst title = document.querySelector('.products-quantity-title');\nconst totalPrice = document.querySelector('.products-total-price');\nconst containerCart = document.querySelector('.cart-container');\nconst cartWrapper = document.querySelector('.cart-desktop-wrapper');\nconst emptyCart = document.querySelector('.cart-empty');\nconst deleteAllBtn = document.querySelector('.del-all-wrapper');\nconst KEY = 'products in cart';\n\nconst formEmailRet = document.querySelector('.form-checkout');\nconst formInputRet = document.getElementById('.inputEmail');\nconst btnSumbit = document.querySelector('.btnCheckout');\n\nrenderCart();\n\n// очистка всієї корзини (localStorage)\ndeleteAllBtn.addEventListener('click', clearCart);\nfunction clearCart() {\n   localStorage.removeItem(KEY);\n   renderCart();\n}\n\n// якщо localStorage пустий, показувати розмітку пустої корзини\n// і приховувати розмітку товарів.\n// Викликається в cart.page.js\nexport function renderCart() {\n   addCounter();\n   const products = JSON.parse(localStorage.getItem(KEY));\n\n   if (products === null || products === undefined || products.length === 0) {\n      cartWrapper.style.display = 'none';\n      emptyCart.style.display = 'block';\n      containerCart.innerHTML = '';\n      title.textContent = 'Cart (0)';\n      totalPrice.textContent = '$0';\n   } else {\n      containerCart.innerHTML = '';\n      // cartWrapper.style.display = 'flex';\n      emptyCart.style.display = 'none';\n\n      containerCart.insertAdjacentHTML('beforeend', createMarkupCart(products));\n      const productsQuantity = document.querySelectorAll('.products-quantity');\n\n      products.forEach((el, index) => {\n         productsQuantity[index].textContent = el.quantity;\n      });\n\n      countTotal(products);\n   }\n}\n\n// видалення конкретного продукту\n// можна оптимізувати ??\ncontainerCart.addEventListener('click', removeProduct);\nfunction removeProduct(event) {\n   if (\n      event.target.className !== 'remove-btn'\n      && event.target.className !== 'remove-btn-img') {\n      return;\n   }\n\n   const selectedItem = event.target.closest('.cart-list-item');\n   const selectedItemId = selectedItem.id;\n   const products = JSON.parse(localStorage.getItem(KEY));\n   const index = products.findIndex(item => item._id === selectedItemId);\n\n   products.splice(index, 1);\n   localStorage.setItem(KEY, JSON.stringify(products));\n   selectedItem.remove();\n   addCounter();\n\n   countTotal(products);\n\n   if (products === null || products === undefined || products.length === 0) {\n      renderCart();\n      return;\n   }\n}\n\n// віднімання і додавання кількості продукту\n// логіка в тому, щоб дозволити юзеру мати 0 продуктів не видаляючи його\n// з першого разу, але на другий клік по мінусу він видаляється\n// (на випадок того, коли випадково проклікав, щоб мати змогу доддати кількість знову).\n// !!!\n// на майбутнє - треба прописати логіку, щоб при кліку на checkout\n// юзеру вилітало повідомлення, щоб або видалив, або додав кількість більше за 0.\n// Тобто, при кліку на кнопку Checkout, треба пройтись по localStorage(KEY), і якщо є хоч один обєкт з quantity: 0, вивести повідомлення\ncontainerCart.addEventListener('click', changeQuantity);\nfunction changeQuantity(event) {\n   if (\n      event.target.className !== 'more-btn-img'\n      && event.target.className !== 'less-btn'\n      && event.target.className !== 'more-btn-card'\n      && event.target.className !== 'less-btn-img'\n   ) {\n      return;\n   }\n\n   const selectedItem = event.target.closest('.cart-list-item');\n   const selectedItemId = selectedItem.id;\n   const products = JSON.parse(localStorage.getItem(KEY));\n   const index = products.findIndex(item => item._id === selectedItemId);\n   const productQuantity = selectedItem.querySelector('.products-quantity');\n\n   // тут обробляємо додавання\n   if (\n      event.target.className === 'more-btn-card'\n      || event.target.className === 'more-btn-img'\n   ) {\n      products[index].quantity++;\n      productQuantity.innerHTML = products[index].quantity;\n      localStorage.setItem(KEY, JSON.stringify(products));\n      countTotal(products)\n   }\n\n   // тут обробляємо віднімання\n   if (\n      event.target.className === 'less-btn'\n      || event.target.className === 'less-btn-img'\n   ) {\n      // тут не даємо обрати кількість менше 1\n      if (products[index].quantity === 1) {\n         // //тут видаляємо при повторному кліку на мінус, коли кількість товару нуль\n         // products.splice(index, 1);\n         // selectedItem.remove();\n         // localStorage.setItem(KEY, JSON.stringify(products));\n         // addCounter();\n         // countTotal(products);\n         // // тут показуємо пусту корзину, коли товарів не залишилось взагалі\n         // if (products === null || products === undefined || products.length === 0) {\n         //   renderCart();\n         // }\n         return;\n      }\n      // віднімання\n      products[index].quantity--;\n      productQuantity.innerHTML = products[index].quantity;\n      localStorage.setItem(KEY, JSON.stringify(products));\n      countTotal(products)\n   }\n}\n\n// обрахунок суми кошика\nfunction countTotal(obj) {\n   title.textContent = `Cart (${obj.length})`;\n   const total = obj.reduce((acc, { quantity, price }) => {\n      return (acc += quantity * price);\n   }, 0);\n   totalPrice.textContent = `$${total.toFixed(2)}`;\n}\n\n//email and checkout\nformEmailRet.addEventListener('sumbit', function (evt) {\n   if (!formEmailRet.value) {\n      alert('Please enter a valid email');\n\n      //return;\n   }\n});\n// document\n//   .getElementById('subscribeFormEm')\n//   .addEventListener('submit', function (event) {\n//     event.preventDefault();\n\n//     var emailInput = document.getElementById('form');\n//     var email = emailInput.value;\n// console.log(email)\n//     if (!validateEmail(email)) {\n//       alert('Please enter a valid email address');\n//       return;\n//     }\n\n//     // Відправляємо дані на сервер за допомогою fetch\n//     fetch('', {\n//       method: 'POST',\n//       headers: {\n//         'Content-Type': 'application/json',\n//       },\n//       body: JSON.stringify({ email: email }),\n//     })\n//       .then(response => {\n//         if (!response.ok) {\n//           throw new Error('Network response was not ok');\n//         }\n//         console.log('Data sent successfully');\n//         // Очищаємо поле введення після успішної відправки\n//         emailInput.value = '';\n//       })\n//       .catch(error => {\n//         console.error('There was a problem with the fetch operation:', error);\n//       });\n//   });\n\n// // Функція для перевірки коректності введеної електронної пошти\n// function validateEmail(email) {\n//   var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n//   return emailRegex.test(email);\n// }\n\n\n\n//modal window\n\n//const closeBtn = document.querySelector(\".btn-close\")\nconst btnCheckout = document.querySelector('.btnCheckout')\nconst modalCheckout = document.querySelector('.modal')\nconst formOrder = document.querySelector('#formCheckoutEmail')\nconst inputOrder = document.querySelector('#formCheckoutInput')\n\nformOrder.addEventListener('submit', handleOrder);\n//inputOrder.addEventListener('keyup', handleKeyPress);\n\nfunction handleOrder(event) {\n   event.preventDefault();\n   const email = inputOrder.value.trim();\n   const products = JSON.parse(localStorage.getItem(KEY));\n\n   const productsInCart = products.reduce((acc, { quantity }) => {\n      return (acc += quantity);\n   }, 0);\n\n   if (productsInCart === 0) {\n      alert(`You must add products' quantity!`)\n      return;\n   }\n   //if (!validateEmail(email)) {\n   //   alert('Please enter a valid email address');\n   //   return;\n   //}\n\n   if (email === '') {\n      alert('Please enter an email address');\n      return;\n   }\n\n   sendDataToServer({ email })\n      .then(() => {\n         console.log('Data sent successfully');\n         inputOrder.value = '';\n         clearCart()\n         modalCheckout.style.display = \"block\";\n      })\n      .catch(error => {\n         console.error('There was a problem with the fetchoperation:', error);\n      });\n}\n\nvar span = document.getElementsByClassName(\"close\")[0];\n\nspan.onclick = function () {\n   modalCheckout.style.display = \"none\";\n}\n\n\nwindow.onclick = function (event) {\n   if (event.currentTarget.className !== 'modal') {\n      modalCheckout.style.display = \"none\";\n   }\n}\n\n//function validateEmail(email) {\n//   const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n//   return emailRegex.test(email);\n//}\n\n//function handleKeyPress(event) {\n//   if (event.key === 'Enter') {\n//      handleFormSubmit(event);\n//   }\n//}\n\nfunction sendDataToServer(data) {\n   return new Promise((resolve, reject) => {\n      setTimeout(() => {\n         console.log('Imitating sending data to server:', data);\n         resolve();\n      }, 2000);\n   });\n}","import { handleHeaderScroll } from './js/base-js/scroll';\nimport 'basiclightbox/dist/basicLightbox.min.css'\nhandleHeaderScroll();"],"names":["title","totalPrice","containerCart","cartWrapper","emptyCart","deleteAllBtn","KEY","formEmailRet","renderCart","clearCart","addCounter","products","createMarkupCart","productsQuantity","el","index","countTotal","removeProduct","event","selectedItem","selectedItemId","item","changeQuantity","productQuantity","obj","total","acc","quantity","price","evt","modalCheckout","formOrder","inputOrder","handleOrder","email","sendDataToServer","error","span","data","resolve","reject","handleHeaderScroll"],"mappings":"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"}
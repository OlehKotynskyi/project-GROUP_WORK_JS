import{b as k,a as u,d as x,e as B,f as C,h as J}from"./assets/scroll-fbb1291e.js";import{P as H,a as w,S as _,b as D}from"./assets/vendor-4b9aba64.js";const I=document.getElementById("pagination");let m=0;const F=window.innerWidth;F<768?m=2:m=4;function A(t,e,o){const s={totalItems:t.totalPages*e,itemsPerPage:e,visiblePages:m,page:o,centerAlign:!1,template:{page:'<a href="#" class="tui-page-btn">{{page}}</a>',currentPage:'<strong class="tui-page-btn tui-is-selected">{{page}}</strong>',moveButton:'<a href="#" class="tui-page-btn tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></a>',disabledMoveButton:'<span class="tui-page-btn tui-is-disabled tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></span>',moreButton:'<a href="#" class="tui-page-btn tui-is-disabled tui-{{type}}-is-ellip"><span class="tui-ico-ellip">...</span></a>'}};new H(I,s).on("afterMove",n=>{const r=n.page;var c=JSON.parse(localStorage.getItem("filters"))||{};c.page=r,localStorage.setItem("filters",JSON.stringify(c)),d()})}function j(){I.innerHTML=""}async function L(t,e,o,s,a){try{const n={keyword:e||"",category:t||"",page:o||1,limit:s||6};a&&(n.sort=a);const r=await w({method:"get",url:"https://food-boutique.b.goit.study/api/products",params:n});return r.data.totalPages>1?A(r.data,s,o):j(),r.data.results}catch(n){return console.error("Error fetching products:",n),[]}}async function l(t){return(await w(`https://food-boutique.b.goit.study/api/products/${t}`)).data}const h="/project-GROUP_WORK_JS/assets/check-267a6277.svg",E=document.querySelector(".products-container"),N=document.querySelector(".popular-container"),q=document.querySelector(".discount-container"),i="products in cart";function P(t){const e=document.querySelector(".products-container");!t||t.length===0?e.innerHTML=`<div class="cart-empty empty-filter">
           <h3 class="products-titel">Nothing was found for the selected <span>filters...</span></h3>
           <p class="filters-text-not-found">Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.</p>
       </div>`:e.innerHTML=k(t)}T();function U(t){for(let e=t.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[t[e],t[o]]=[t[o],t[e]]}}async function W(){try{const t=await l("popular"),e=v(t),o=M(e,5);N.innerHTML=x(o)}catch(t){console.log(t.message)}}W();async function T(){try{const t=await L("Fresh_Produce");E.insertAdjacentHTML("beforeend",k(v(t))),u()}catch(t){console.log(t.message)}}T();function M(t,e){return U(t),t.slice(0,e)}async function $(){try{const t=await l("discount"),e=M(t,2);q.innerHTML=B(e)}catch(t){console.log(t.message)}}q.addEventListener("click",R);async function R(t){if(t.target.className==="discount-link-basket"||t.target.className==="discount-basket-icon"||t.target.className==="discount-basket-icon"){const e=t.target.closest(".discount-list-item"),o=e.id;try{const s=await l(o),a=JSON.parse(localStorage.getItem(i))??[],n=a.findIndex(r=>r._id===o);if(n!==-1)a[n].quantity+=0;else{s.quantity=1,a.push(s);const r=e.querySelector("button");r.disabled=!0,r.innerHTML=`<span class="icon-styles">
                     <img class="discount-basket-icon" src="${h}" alt="icon bascket" width="18" height="18">

                  </span>`,r.classList.add("disabled")}localStorage.setItem(i,JSON.stringify(a)),u()}catch(s){console.log(s.message)}}}$();E.addEventListener("click",y);async function y(t){if(t.target.nodeName==="BUTTON"||t.target.className==="add-btn"||t.target.nodeName==="IMG"){const e=t.target.closest(".list-item-body-price"),o=e.parentElement.id;try{const s=await l(o),a=JSON.parse(localStorage.getItem(i))??[],n=a.findIndex(r=>r._id===o);if(n!==-1)a[n].quantity+=0;else{s.quantity=1,a.push(s);const r=e.querySelector("button");r.disabled=!0,r.innerHTML=`<img src="${h}" alt="icon check" width="18" height="18">`,r.classList.add("disabled")}localStorage.setItem(i,JSON.stringify(a)),u()}catch{console.error()}}}N.addEventListener("click",z);async function z(t){if(t.target.nodeName==="BUTTON"||t.target.className==="popular-basket-img"){const e=t.target.closest(".product-popular-card"),o=e.id,s=e.querySelector("button");s.disabled=!0;try{const a=await l(o),n=JSON.parse(localStorage.getItem(i))??[],r=n.findIndex(c=>c._id===o);r!==-1?n[r].quantity+=0:(a.quantity=1,n.push(a),s.innerHTML=`<img class="popular-disadbled-img" src="${h}" alt="icon bascket" width="20" height="20">`,s.classList.add("popular-disadbled-btn")),localStorage.setItem(i,JSON.stringify(n)),u()}catch(a){console.log(a.message),s.disabled=!1}}}function v(t){return t.map(e=>{let o=e.category;return typeof o=="string"&&(o=o.split("_").join(" ")),{...e,category:o}})}let p=!1;function G(t,e,o){let s;return function(){const a=this,n=arguments,r=function(){s=null,o||t.apply(a,n)},c=o&&!s;clearTimeout(s),s=setTimeout(r,e),c&&t.apply(a,n)}}document.addEventListener("DOMContentLoaded",function(){tt(),Q(),X(),et();const t=document.getElementById("search-box"),e=document.getElementById("categories"),o=g();t.value=o.keyword||"",e.value=o.category||"",d()});const K=document.querySelector(".search-form");K.addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("search-box").value.trim();b("keyword",e),d(),Z()});function Y(){const t=window.innerWidth,e=t>375&&t<=768;let o=6;e?o=8:t>768&&t<=1440&&(o=9);const s=g();s.limit=o,localStorage.setItem("filters",JSON.stringify(s)),d()}window.addEventListener("resize",G(Y,300));async function Q(){try{const t=await fetch("https://food-boutique.b.goit.study/api/products/categories");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();e&&e.length>0?V(e):console.error("No categories found")}catch(t){console.error("Error fetching categories:",t)}}function V(t){const e=document.getElementById("categories");e.innerHTML="";const o=[{text:"Show all",value:""},...t.map(s=>({text:s.replace(/_/g," "),value:s}))];new _({select:"#categories",placeholder:"Categories",showSearch:!1,data:o})}function X(){document.getElementById("categories").addEventListener("change",function(){const e=this.value;b("category",e),d()})}function Z(){b("page",1)}async function d(){if(p)return;p=!0;const t=g(),{category:e,keyword:o,page:s,limit:a}=t;try{const n=await L(e,o,s,a);P(n)}catch(n){console.error("Error fetching products:",n),P([])}finally{p=!1}}function tt(){localStorage.getItem("filters")||O()}function b(t,e){const o=g();o[t]=e,localStorage.setItem("filters",JSON.stringify(o))}function O(){localStorage.setItem("filters",JSON.stringify({keyword:null,category:null,page:1,limit:6}))}function g(){return JSON.parse(localStorage.getItem("filters"))||O()}function et(){d()}const ot=document.querySelector(".products-container"),st=document.querySelector(".popular-container"),nt=document.querySelector(".discount-container");ot.addEventListener("click",S);st.addEventListener("click",S);nt.addEventListener("click",S);function S(t){if(!(t.target===t.currentTarget||t.target.nodeName==="BUTTON"||t.target.className==="add-btn"||t.target.className==="popular-basket-img"||t.target.className==="icon-styles"||t.target.className==="discount-basket-icon"||t.target.alt==="icon bascket")){if(t.target.closest(".discount-list-item")!==null){const o=t.target.closest(".discount-list-item").id;f(o)}if(t.target.closest(".list-item")!==null){const o=t.target.closest(".list-item").id;f(o)}if(t.target.closest(".product-popular-card")!==null){const o=t.target.closest(".product-popular-card").id;f(o)}}}async function f(t,e){try{let r=function(c){(c.target.className==="remove-btn"||c.target.className==="remove-btn-img")&&a.close()};const o=[await l(t)],s=c=>{a.visible()&&c.key==="Escape"&&a.close()},a=D.create(C(o),{onClose:c=>document.removeEventListener("keydown",s),onClose:c=>n.querySelector(".add-btn").removeEventListener("click",y),onClose:c=>n.removeEventListener("click",r)});a.show(),document.addEventListener("keydown",s);const n=document.querySelector(".basicLightbox__placeholder");n.querySelector(".add-btn").addEventListener("click",y),n.addEventListener("click",r)}catch(o){console.log(o.message)}}J();
//# sourceMappingURL=commonHelpers2.js.map

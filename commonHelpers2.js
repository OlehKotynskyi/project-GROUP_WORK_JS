import{a as S,b as I,d as T,e as O,h as D}from"./assets/scroll-6d82b88a.js";import{a as E}from"./assets/vendor-a61d8330.js";async function q(e,t,o,n,c){try{const r={keyword:t||"",category:e||"",page:o||1,limit:n||6};return c&&(r.sort=c),(await E({method:"get",url:"https://food-boutique.b.goit.study/api/products",params:r})).data.results}catch(r){return console.error("Error fetching products:",r),[]}}async function f(e){return(await E(`https://food-boutique.b.goit.study/api/products/${e}`)).data}const v=document.querySelector(".products-container"),B=document.querySelector(".popular-container"),N=document.querySelector(".discount-container"),u="products in cart";function L(e){const t=document.querySelector(".products-container");!e||e.length===0?t.innerHTML=`<p>Nothing was found for the selected filters...</p>
                              <p>Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.</p>`:t.innerHTML=I(b(e))}function F(){const e=window.innerWidth;return e<375?6:e>=375&&e<768?8:9}async function H(){try{const e=await q("Fresh_Produce");v.insertAdjacentHTML("beforeend",I(b(e))),S()}catch(e){console.log(e.message)}}H();function J(e){for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}}function P(e,t){return J(e),e.slice(0,t)}async function R(){try{const e=await f("popular"),t=P(e,5);B.innerHTML=T(t)}catch(e){console.log(e.message)}}R();async function _(){try{const e=await f("discount"),t=P(e,2);N.innerHTML=O(t)}catch(e){console.log(e.message)}}_();v.addEventListener("click",j);async function j(e){if(console.log(e.target.nodeName),console.log(e.target.className),e.target.className==="add-btn"||e.target.nodeName==="IMG"){const o=e.target.closest(".list-item").id;try{const n=await f(o),c=JSON.parse(localStorage.getItem(u))??[],r=c.findIndex(l=>l._id===o);r!==-1?c[r].quantity+=1:(n.quantity=1,c.push(n)),localStorage.setItem(u,JSON.stringify(c)),S()}catch(n){console.log(n.message)}return}}N.addEventListener("click",W);async function W(e){if(e.target.nodeName==="BUTTON"||e.target.nodeName==="IMG"||e.target.nodeName==="SPAN"){console.dir(e.target.className);const o=e.target.closest(".discount-list-item").id;try{const n=await f(o),c=JSON.parse(localStorage.getItem(u))??[],r=c.findIndex(l=>l._id===o);r!==-1?c[r].quantity+=1:(n.quantity=1,c.push(n)),localStorage.setItem(u,JSON.stringify(c)),S()}catch(n){console.log(n.message)}}}function b(e){return e.map(t=>{let o=t.category;return typeof o=="string"&&(o=o.split("_").join(" ")),{...t,category:o}})}document.addEventListener("DOMContentLoaded",function(){G(),U(),z(),K()});window.addEventListener("resize",()=>{d()});async function U(){try{const t=await(await fetch("https://food-boutique.b.goit.study/api/products/categories")).json();$(t)}catch(e){console.error("Error fetching categories:",e)}}function $(e){const t=document.getElementById("categories");t.appendChild(new Option("Show all","")),e.forEach(n=>{const c=document.createElement("option");c.value=n,c.textContent=n.replace(/_/g," "),t.appendChild(c)});const o=k();o.category&&(t.value=o.category)}function z(){const e=document.querySelector(".search-form"),t=document.getElementById("categories");e.addEventListener("submit",function(o){o.preventDefault();const n=document.getElementById("search-box").value;w("keyword",n),d()}),t.addEventListener("change",function(){w("category",this.value),d()})}async function d(){const e=k(),t=F();try{const o=await q(e.category,e.keyword,e.page,t);L(o)}catch(o){console.error("Error fetching products:",o),L([])}}function G(){localStorage.getItem("filters")||x()}function w(e,t){const o=k();o[e]=t,localStorage.setItem("filters",JSON.stringify(o))}function x(){localStorage.setItem("filters",JSON.stringify({keyword:null,category:null,page:1,limit:6}))}function k(){return JSON.parse(localStorage.getItem("filters"))||x()}function K(){d()}const g=document.querySelector(".popup"),V=document.querySelector(".products-container ");document.querySelector(".popup-close");V.addEventListener("click",Y);function Y(e){if(e.target===e.currentTarget)return;const t=e.target.closest(".list-item").id,o=document.getElementById(t);g.innerHTML=o.outerHTML,g.style.display="flex",document.addEventListener("keydown",n);function n(c){c.key==="Escape"&&(g.style.display="none",document.removeEventListener("keydown",n))}}const m=document.querySelectorAll(".popup-link"),p=document.querySelector("body"),s=document.querySelectorAll(".lock-padding");let i=!0;const h=800;if(m.length>0)for(let e=0;e<m.length;e++){const t=m[e];t.addEventListener("click",function(o){const n=t.getAttribute("href").replace("#",""),c=document.getElementById(n);C(c),o.preventDefault()})}const y=document.querySelectorAll(".close-popup");if(y.length>0)for(let e=0;e<y.length;e++){const t=y[e];t.addEventListener("click",function(o){a(t.closest(".popup")),o.preventDefault()})}function C(e){if(e&&i){const t=document.querySelector(".popup.open");t?a(t,!1):A(),e.classList.add("open"),e.addEventListener("click",function(o){o.target.closest(".popup-content")||a(o.target.closest(".popup"))})}}function a(e,t=!0){i&&(e.classList.remove("open"),t&&M())}function A(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(s.length>0)for(let t=0;t<s.length;t++){const o=s[t];o.style.paddingRight=e}p.style.paddingRight=e,p.classList.add("lock"),i=!1,setTimeout(function(){i=!0},h)}function M(){setTimeout(function(){if(s.length>0)for(let e=0;e<s.length;e++){const t=s[e];t.style.paddingRight="0px"}p.style.paddingRight="0px",p.classList.remove("lock")},h),i=!1,setTimeout(function(){i=!0},h)}document.addEventListener("keydown",function(e){if(e.code==="Escape"){const t=document.querySelector(".popup.open");a(t)}});D();const Q=document.querySelectorAll(".popup-link");C(Q[0]);const X=document.querySelector(".close-popup");a(X.closest(".popup"));A();M();
//# sourceMappingURL=commonHelpers2.js.map

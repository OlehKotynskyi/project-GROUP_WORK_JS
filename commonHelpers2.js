import{b as I,a as P,d as H,e as F,h as J}from"./assets/scroll-1fc55454.js";import{P as W,a as E}from"./assets/vendor-b592f4c5.js";const v=document.getElementById("pagination");let h=0;const R=window.innerWidth;R<768?h=2:h=4;function _(e,t,o){const n={totalItems:e.totalPages*t,itemsPerPage:t,visiblePages:h,page:o,centerAlign:!1,template:{page:'<a href="#" class="tui-page-btn">{{page}}</a>',currentPage:'<strong class="tui-page-btn tui-is-selected">{{page}}</strong>',moveButton:'<a href="#" class="tui-page-btn tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></a>',disabledMoveButton:'<span class="tui-page-btn tui-is-disabled tui-{{type}}"><span class="tui-ico-{{type}}">{{type}}</span></span>',moreButton:'<a href="#" class="tui-page-btn tui-is-disabled tui-{{type}}-is-ellip"><span class="tui-ico-ellip">...</span></a>'}};new W(v,n).on("afterMove",r=>{const s=r.page;var L=JSON.parse(localStorage.getItem("filters"))||{};L.page=s,localStorage.setItem("filters",JSON.stringify(L)),i()})}function j(){v.innerHTML=""}async function q(e,t,o,n,c){try{const r={keyword:t||"",category:e||"",page:o||1,limit:n||6};c&&(r.sort=c);const s=await E({method:"get",url:"https://food-boutique.b.goit.study/api/products",params:r});return s.data.totalPages>1?_(s.data,n,o):j(),s.data.results}catch(r){return console.error("Error fetching products:",r),[]}}async function g(e){return(await E(`https://food-boutique.b.goit.study/api/products/${e}`)).data}const N=document.querySelector(".products-container"),M=document.querySelector(".popular-container"),T=document.querySelector(".discount-container"),S="products in cart";function b(e){const t=document.querySelector(".products-container");!e||e.length===0?t.innerHTML=`<p>Nothing was found for the selected filters...</p>
                              <p>Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.</p>`:t.innerHTML=I(e)}function U(){const e=window.innerWidth;return e<768?6:e>=768&&e<1440?8:9}G();function $(e){for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}}async function z(){try{const e=await g("popular"),t=x(e),o=C(t,5);M.innerHTML=H(o)}catch(e){console.log(e.message)}}z();async function G(){try{const e=await q("Fresh_Produce");N.insertAdjacentHTML("beforeend",I(x(e))),P()}catch(e){console.log(e.message)}}function C(e,t){return $(e),e.slice(0,t)}async function K(){try{const e=await g("discount"),t=C(e,2);T.innerHTML=F(t)}catch(e){console.log(e.message)}}T.addEventListener("click",V);async function V(e){if(e.target.nodeName==="BUTTON"||e.target.nodeName==="IMG"||e.target.nodeName==="SPAN"){console.dir(e.target.className);const o=e.target.closest(".discount-list-item").id;try{const n=await g(o),c=JSON.parse(localStorage.getItem(S))??[],r=c.findIndex(s=>s._id===o);r!==-1?c[r].quantity+=1:(n.quantity=1,c.push(n))}catch{console.error()}}}K();N.addEventListener("click",Y);async function Y(e){console.log(e.target.nodeName),console.log(e.target.className),(e.target.className==="add-btn"||e.target.nodeName==="IMG")&&e.target.closest(".list-item")}M.addEventListener("click",Q);async function Q(e){if(e.target.nodeName==="BUTTON"||e.target.nodeName==="svg"||e.target.nodeName==="use"){const t=e.target.closest(".product-popular-card"),o=t.id;try{const n=await g(o),c=JSON.parse(localStorage.getItem(S))??[],r=c.findIndex(s=>s._id===o);if(r!==-1)c[r].quantity+=1;else{n.quantity=0,c.push(n);const s=t.querySelector("button");s.disabled=!0,s.innerHTML=`<svg class="popular-basket-svg" width="12" height="12">
         <use href="../img/sprite.svg#icon-check"></use>
         </svg>`}localStorage.setItem(S,JSON.stringify(c)),P()}catch(n){console.log(n.message)}}}function x(e){return e.map(t=>{let o=t.category;return typeof o=="string"&&(o=o.split("_").join(" ")),{...t,category:o}})}document.addEventListener("DOMContentLoaded",function(){te(),X(),ee(),oe()});window.addEventListener("resize",()=>{i()});async function X(){try{const t=await(await fetch("https://food-boutique.b.goit.study/api/products/categories")).json();Z(t)}catch(e){console.error("Error fetching categories:",e)}}function Z(e){const t=document.getElementById("categories");t.appendChild(new Option("Show all","")),e.forEach(n=>{const c=document.createElement("option");c.value=n,c.textContent=n.replace(/_/g," "),t.appendChild(c)});const o=w();o.category&&(t.value=o.category)}function ee(){const e=document.querySelector(".search-form"),t=document.getElementById("categories");e.addEventListener("submit",function(o){o.preventDefault();const n=document.getElementById("search-box").value;n==""?(a("keyword",null),i(),a("page",1)):(a("keyword",n),i(),a("page",1))}),t.addEventListener("change",function(){this.value=="Show all"?(a("category",null),a("page",1),i()):(a("category",this.value),a("page",1),i())})}async function i(){const e=w(),t=U();try{const o=await q(e.category,e.keyword,e.page,t);b(o)}catch(o){console.error("Error fetching products:",o),b([])}}function te(){localStorage.getItem("filters")||A()}function a(e,t){const o=w();o[e]=t,localStorage.setItem("filters",JSON.stringify(o))}function A(){localStorage.setItem("filters",JSON.stringify({keyword:null,category:null,page:1,limit:6}))}function w(){return JSON.parse(localStorage.getItem("filters"))||A()}function oe(){i()}const f=document.querySelector(".popup"),ne=document.querySelector(".products-container ");document.querySelector(".popup-close");ne.addEventListener("click",ce);function ce(e){if(e.target===e.currentTarget)return;const t=e.target.closest(".list-item").id,o=document.getElementById(t);f.innerHTML=o.outerHTML,f.style.display="flex",document.addEventListener("keydown",n);function n(c){c.key==="Escape"&&(f.style.display="none",document.removeEventListener("keydown",n))}}const m=document.querySelectorAll(".popup-link"),p=document.querySelector("body"),l=document.querySelectorAll(".lock-padding");let u=!0;const k=800;if(m.length>0)for(let e=0;e<m.length;e++){const t=m[e];t.addEventListener("click",function(o){const n=t.getAttribute("href").replace("#",""),c=document.getElementById(n);B(c),o.preventDefault()})}const y=document.querySelectorAll(".close-popup");if(y.length>0)for(let e=0;e<y.length;e++){const t=y[e];t.addEventListener("click",function(o){d(t.closest(".popup")),o.preventDefault()})}function B(e){if(e&&u){const t=document.querySelector(".popup.open");t?d(t,!1):O(),e.classList.add("open"),e.addEventListener("click",function(o){o.target.closest(".popup-content")||d(o.target.closest(".popup"))})}}function d(e,t=!0){u&&(e.classList.remove("open"),t&&D())}function O(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(l.length>0)for(let t=0;t<l.length;t++){const o=l[t];o.style.paddingRight=e}p.style.paddingRight=e,p.classList.add("lock"),u=!1,setTimeout(function(){u=!0},k)}function D(){setTimeout(function(){if(l.length>0)for(let e=0;e<l.length;e++){const t=l[e];t.style.paddingRight="0px"}p.style.paddingRight="0px",p.classList.remove("lock")},k),u=!1,setTimeout(function(){u=!0},k)}document.addEventListener("keydown",function(e){if(e.code==="Escape"){const t=document.querySelector(".popup.open");d(t)}});J();const re=document.querySelectorAll(".popup-link");B(re[0]);const se=document.querySelector(".close-popup");d(se.closest(".popup"));O();D();
//# sourceMappingURL=commonHelpers2.js.map
